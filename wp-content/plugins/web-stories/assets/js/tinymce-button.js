(()=>{"use strict";var e={n:t=>{var i=t&&t.__esModule?()=>t.default:()=>t;return e.d(i,{a:i}),i},d:(t,i)=>{for(var n in i)e.o(i,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:i[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{setCurrentView:()=>w,setEditor:()=>g,setSettings:()=>d,setViewSettings:()=>b,toggleModal:()=>u});var i={};e.r(i),e.d(i,{getCurrentView:()=>E,getCurrentViewSettings:()=>j,getEditor:()=>p,getModal:()=>M,getSettings:()=>f,getState:()=>N});const n=window.React;var r=e.n(n);const o=window.wp.element,l=window.wp.data,s=window.wp.i18n,a=window.wp.domReady;var c=e.n(a);function d(e){return{type:"SET_SETTINGS",settings:e}}function u(e){return{type:"TOGGLE_MODAL",modalOpen:e}}function g(e){return{type:"SET_EDITOR",editor:e}}function w(e){return{type:"SET_CURRENT_VIEW",currentView:e}}function b(e,t){return{type:"SET_VIEW_SETTINGS",view:e,settings:t}}const _={settings:(()=>{const e=[],{views:t=[],fields:i}=window.webStoriesData||{};return t.forEach((t=>{const{value:n}=t,{title:r,author:o,date:l,excerpt:s,archive_link:a,sharp_corners:c}=i[n];e[n]={title:r,excerpt:s,author:o,date:l,archive_link:a,archive_link_label:"",circle_size:150,sharp_corners:c,image_alignment:"left",number_of_columns:1,number_of_stories:5,order:"DESC",orderby:"post_title",view:n}})),e})(),modalOpen:!1,editor:!1,currentView:"circles"};const m=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SETTINGS":return{...e,settings:t.settings};case"TOGGLE_MODAL":return{...e,modalOpen:t.modalOpen};case"SET_EDITOR":return{...e,editor:t.editor};case"SET_CURRENT_VIEW":return{...e,currentView:t.currentView};case"SET_VIEW_SETTINGS":return{...e,settings:{...e.settings,[t.view]:t.settings}};default:return e}};function f(e){return e.settings}function M(e){return e.modalOpen}function p(e){return e.editor}function E(e){return e.currentView}function j(e){const t=E(e);return e.settings[t]}function N(e){return e}const h=(0,l.createReduxStore)("web-stories-mce",{actions:t,reducer:m,selectors:i});(0,l.register)(h);const C=h,S=window.wp.compose,I=window.wp.components,y=e=>{let{fieldObj:t,field:i,hidden:n=!1}=e;const r=(0,l.select)(C).getCurrentViewSettings();let o=r;if("object"==typeof t){if(!n){const{show:e}=t;o={...r,[i]:{...t,show:!e}}}}else o={...r,[i]:t};(0,l.dispatch)(C).setViewSettings((0,l.select)(C).getCurrentView(),o)},D=()=>{let e="[web_stories";const t=(0,l.select)(C).getEditor(),i=(0,l.select)(C).getCurrentViewSettings();return t&&Object.keys(i).forEach((t=>{const n=i[t],r="object"==typeof n?n.show.toString():n.toString();e+=` ${t.toString()}="${r}"`})),e+=" /]",e},Toggle=e=>{const{fieldObj:t={},field:i}=e,{show:n,hidden:o,label:l}=t;return o?null:r().createElement(I.ToggleControl,{label:l,checked:n,onChange:()=>{y({fieldObj:t,field:i,hidden:o})}})},Modal=e=>{const{modalOpen:t,settings:i={},prepareShortCode:n}=e,{author:o,date:a,title:c,number_of_stories:d,order:u,orderby:g,view:w,excerpt:b,image_alignment:_,archive_link:m,circle_size:f,number_of_columns:M,sharp_corners:p,archive_link_label:E}=i,{views:j=[],fields:N}=window.webStoriesData||{},h=e=>N?.[w][e].show&&!N?.[w][e].hidden;return t?r().createElement(I.Modal,{onRequestClose:()=>{(0,l.dispatch)(C).toggleModal(!1)},closeButtonLabel:(0,s.__)("Close","web-stories"),title:(0,s.__)("Web Stories","web-stories"),className:"component_web_stories_mce_model",shouldCloseOnClickOutside:!1},r().createElement(I.SelectControl,{label:(0,s.__)("Select Layout","web-stories"),value:w,options:j,onChange:e=>{(0,l.dispatch)(C).setCurrentView(e)}}),r().createElement(I.RangeControl,{label:(0,s.__)("Number of Stories","web-stories"),value:d,min:1,max:20,onChange:e=>{y({fieldObj:Number(e),field:"number_of_stories"})}}),r().createElement(I.SelectControl,{label:(0,s.__)("Order By","web-stories"),value:g,options:[{value:"post_date",label:(0,s.__)("Date","web-stories")},{value:"post_title",label:(0,s.__)("Title","web-stories")}],onChange:e=>{y({fieldObj:e,field:"orderby"})}}),r().createElement(I.SelectControl,{label:(0,s.__)("Order","web-stories"),value:u,options:[{value:"ASC",label:(0,s.__)("Ascending","web-stories")},{value:"DESC",label:(0,s.__)("Descending","web-stories")}],onChange:e=>{y({fieldObj:e,field:"order"})}}),r().createElement(Toggle,{field:"title",fieldObj:c}),r().createElement(Toggle,{field:"excerpt",fieldObj:b}),r().createElement(Toggle,{field:"author",fieldObj:o}),r().createElement(Toggle,{field:"date",fieldObj:a}),h("image_alignment")&&r().createElement("div",{style:{margin:"0 0 10px 0"}},r().createElement(I.RadioControl,{label:(0,s.__)("Image Alignment","web-stories"),selected:_,options:[{value:"left",label:(0,s.__)("Left","web-stories")},{value:"right",label:(0,s.__)("Right","web-stories")}],onChange:e=>{y({fieldObj:e,field:"image_alignment"})}})),r().createElement(Toggle,{field:"sharp_corners",fieldObj:p}),r().createElement(Toggle,{field:"archive_link",fieldObj:m}),m?.show&&r().createElement(I.TextControl,{label:(0,s.__)("Archive Link Label","web-stories"),value:E,onChange:e=>{y({fieldObj:e,field:"archive_link_label"})}}),f?.show&&r().createElement(I.RangeControl,{label:(0,s.__)("Circle Size","web-stories"),value:f,min:80,max:200,step:5,onChange:e=>y({fieldObj:Number(e),field:"circle_size"})}),h("number_of_columns")&&r().createElement(I.RangeControl,{label:(0,s.__)("Number of Columns","web-stories"),value:M,min:1,max:4,onChange:e=>y({fieldObj:Number(e),field:"number_of_columns"})}),r().createElement("div",{style:{padding:"20px 0"},className:"alignright"},r().createElement(I.Button,{isPrimary:!0,onClick:()=>{const e=(0,l.select)(C).getEditor();if(e){const t=n();e.insertContent(t)}(0,l.dispatch)(C).toggleModal(!1)}},(0,s.__)("Insert","web-stories")),r().createElement(I.Button,{onClick:()=>(0,l.dispatch)(C).toggleModal(!1)},(0,s.__)("Cancel","web-stories")))):null},T=(0,S.compose)([(0,l.withSelect)((e=>({modalOpen:e(C).getModal(),settings:e(C).getCurrentViewSettings(),prepareShortCode:D})))])(Modal),{_:O}=window;O.hasOwnProperty("pluck")||(O.pluck=O.map),tinymce.PluginManager.add("web_stories",(function(e){e.addButton("web_stories",{text:(0,s.__)("Web Stories","web-stories"),classes:"web-stories",image:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjA4IiBoZWlnaHQ9IjIwOCIgdmlld0JveD0iMCAwIDIwOCAyMDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxjaXJjbGUgY3g9IjEwMCIgY3k9IjEwMCIgcj0iMTAwIiBmaWxsPSJibGFjayIvPgo8cGF0aCBkPSJNMTM1LjIgNjIuNDAwNUMxNDAuOTQ0IDYyLjQwMDUgMTQ1LjYgNjcuMDU2NyAxNDUuNiA3Mi44MDA1VjEzNS4yQzE0NS42IDE0MC45NDQgMTQwLjk0NCAxNDUuNiAxMzUuMiAxNDUuNlY2Mi40MDA1WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTU3LjIgNjIuNDAwNUM1Ny4yIDU2LjY1NjcgNjEuODU2MiA1Mi4wMDA1IDY3LjYgNTIuMDAwNUgxMTQuNEMxMjAuMTQ0IDUyLjAwMDUgMTI0LjggNTYuNjU2NyAxMjQuOCA2Mi40MDA1VjE0NS42QzEyNC44IDE1MS4zNDQgMTIwLjE0NCAxNTYgMTE0LjQgMTU2SDY3LjZDNjEuODU2MiAxNTYgNTcuMiAxNTEuMzQ0IDU3LjIgMTQ1LjZWNjIuNDAwNVoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xNTYgNzIuODAwNUMxNjAuMzA4IDcyLjgwMDUgMTYzLjggNzYuMjkyNyAxNjMuOCA4MC42MDA1VjEyNy40QzE2My44IDEzMS43MDggMTYwLjMwOCAxMzUuMiAxNTYgMTM1LjJWNzIuODAwNVoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPg==",onClick:function(){(0,l.dispatch)(C).setEditor(e),(0,l.dispatch)(C).toggleModal(!0)}})})),c()((()=>{const e=document.getElementById("web-stories-tinymce");e&&(0,o.render)(r().createElement(T,null),e)}))})();