(()=>{"use strict";var e={n:t=>{var i=t&&t.__esModule?()=>t.default:()=>t;return e.d(i,{a:i}),i},d:(t,i)=>{for(var n in i)e.o(i,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:i[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{setCurrentView:()=>g,setEditor:()=>u,setSettings:()=>c,setViewSettings:()=>w,toggleModal:()=>d});var i={};e.r(i),e.d(i,{getCurrentView:()=>h,getCurrentViewSettings:()=>C,getEditor:()=>N,getModal:()=>j,getSettings:()=>p,getState:()=>I});const n=window.React;var r=e.n(n);const o=window.wp.element,l=window.wp.data,s=window.wp.i18n,a="web-stories-mce";function c(e){return{type:"SET_SETTINGS",settings:e}}function d(e){return{type:"TOGGLE_MODAL",modalOpen:e}}function u(e){return{type:"SET_EDITOR",editor:e}}function g(e){return{type:"SET_CURRENT_VIEW",currentView:e}}function w(e,t){return{type:"SET_VIEW_SETTINGS",view:e,settings:t}}const{webStoriesData:b}=window,_=e=>{let{fieldObj:t,field:i,hidden:n=!1}=e;const r=(0,l.select)(a).getCurrentViewSettings();let o=r;if("object"==typeof t){if(!n){const{show:e}=t;o={...r,[i]:{...t,show:!e}}}}else o={...r,[i]:t};(0,l.dispatch)(a).setViewSettings((0,l.select)(a).getCurrentView(),o)},m=()=>{let e="[web_stories";const t=(0,l.select)(a).getEditor(),i=(0,l.select)(a).getCurrentViewSettings();return t&&Object.keys(i).forEach((t=>{const n=i[t],r="object"==typeof n?n.show.toString():n.toString();e+=` ${t.toString()}="${r}"`})),e+=" /]",e},f={settings:{},modalOpen:!1,editor:!1,currentView:"circles"};f.settings=(()=>{const e=[],{views:t,fields:i}=b;return t.forEach((t=>{const{value:n}=t,{title:r,author:o,date:l,excerpt:s,archive_link:a,sharp_corners:c}=i[n];e[n]={title:r,excerpt:s,author:o,date:l,archive_link:a,archive_link_label:"",circle_size:150,sharp_corners:c,image_alignment:"left",number_of_columns:1,number_of_stories:5,order:"DESC",orderby:"post_title",view:n}})),e})();const M=f;const E=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SETTINGS":return{...e,settings:t.settings};case"TOGGLE_MODAL":return{...e,modalOpen:t.modalOpen};case"SET_EDITOR":return{...e,editor:t.editor};case"SET_CURRENT_VIEW":return{...e,currentView:t.currentView};case"SET_VIEW_SETTINGS":return{...e,settings:{...e.settings,[t.view]:t.settings}};default:return e}};function p(e){return e.settings}function j(e){return e.modalOpen}function N(e){return e.editor}function h(e){return e.currentView}function C(e){const t=(0,l.select)(a).getCurrentView();return e.settings[t]}function I(e){return e}const S=(0,l.registerStore)(a,{actions:t,reducer:E,selectors:i}),T=window.wp.compose,y=window.wp.components,Toggle=e=>{const{fieldObj:t={},field:i}=e,{show:n,hidden:o,label:l}=t;return o?null:r().createElement(y.ToggleControl,{label:l,checked:n,onChange:()=>{_({fieldObj:t,field:i,hidden:o})}})},Modal=e=>{const{modalOpen:t,settings:i,prepareShortCode:n}=e,{author:o,date:c,title:d,number_of_stories:u,order:g,orderby:w,view:m,excerpt:f,image_alignment:M,archive_link:E,circle_size:p,number_of_columns:j,sharp_corners:N,archive_link_label:h}=i,{views:C={},fields:I}=b,S=e=>I?.[m][e].show&&!I?.[m][e].hidden;return t?r().createElement(y.Modal,{onRequestClose:()=>{(0,l.dispatch)(a).toggleModal(!1)},closeButtonLabel:(0,s.__)("Close","web-stories"),title:(0,s.__)("Web Stories","web-stories"),className:"component_web_stories_mce_model",shouldCloseOnClickOutside:!1},r().createElement(y.SelectControl,{label:(0,s.__)("Select Layout","web-stories"),value:m,options:C,onChange:e=>{(0,l.dispatch)(a).setCurrentView(e)}}),r().createElement(y.RangeControl,{label:(0,s.__)("Number of Stories","web-stories"),value:u,min:1,max:20,onChange:e=>{_({fieldObj:Number(e),field:"number_of_stories"})}}),r().createElement(y.SelectControl,{label:(0,s.__)("Order By","web-stories"),value:w,options:[{value:"post_date",label:(0,s.__)("Date","web-stories")},{value:"post_title",label:(0,s.__)("Title","web-stories")}],onChange:e=>{_({fieldObj:e,field:"orderby"})}}),r().createElement(y.SelectControl,{label:(0,s.__)("Order","web-stories"),value:g,options:[{value:"ASC",label:(0,s.__)("Ascending","web-stories")},{value:"DESC",label:(0,s.__)("Descending","web-stories")}],onChange:e=>{_({fieldObj:e,field:"order"})}}),r().createElement(Toggle,{field:"title",fieldObj:d}),r().createElement(Toggle,{field:"excerpt",fieldObj:f}),r().createElement(Toggle,{field:"author",fieldObj:o}),r().createElement(Toggle,{field:"date",fieldObj:c}),S("image_alignment")&&r().createElement("div",{style:{margin:"0 0 10px 0"}},r().createElement(y.RadioControl,{label:(0,s.__)("Image Alignment","web-stories"),selected:M,options:[{value:"left",label:(0,s.__)("Left","web-stories")},{value:"right",label:(0,s.__)("Right","web-stories")}],onChange:e=>{_({fieldObj:e,field:"image_alignment"})}})),r().createElement(Toggle,{field:"sharp_corners",fieldObj:N}),r().createElement(Toggle,{field:"archive_link",fieldObj:E}),E?.show&&r().createElement(y.TextControl,{label:(0,s.__)("Archive Link Label","web-stories"),value:h,onChange:e=>{_({fieldObj:e,field:"archive_link_label"})}}),p?.show&&r().createElement(y.RangeControl,{label:(0,s.__)("Circle Size","web-stories"),value:p,min:80,max:200,step:5,onChange:e=>_({fieldObj:Number(e),field:"circle_size"})}),S("number_of_columns")&&r().createElement(y.RangeControl,{label:(0,s.__)("Number of Columns","web-stories"),value:j,min:1,max:4,onChange:e=>_({fieldObj:Number(e),field:"number_of_columns"})}),r().createElement("div",{style:{padding:"20px 0"},className:"alignright"},r().createElement(y.Button,{isPrimary:!0,onClick:()=>{const e=(0,l.select)(a).getEditor();if(e){const t=n();e.insertContent(t)}(0,l.dispatch)(a).toggleModal(!1)}},(0,s.__)("Insert","web-stories")),r().createElement(y.Button,{onClick:()=>(0,l.dispatch)(a).toggleModal(!1)},(0,s.__)("Cancel","web-stories")))):null},D=(0,T.compose)([(0,l.withSelect)((e=>({modalOpen:e(a).getModal(),settings:e(a).getCurrentViewSettings(),prepareShortCode:m})))])(Modal),{_:O}=window;O.hasOwnProperty("pluck")||(O.pluck=O.map);S.subscribe((()=>(()=>{const e=document.getElementById("web-stories-tinymce");e&&(0,o.render)(r().createElement(D,null),e)})())),tinymce.PluginManager.add("web_stories",(function(e){e.addButton("web_stories",{text:(0,s.__)("Web Stories","web-stories"),classes:"web-stories",image:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjA4IiBoZWlnaHQ9IjIwOCIgdmlld0JveD0iMCAwIDIwOCAyMDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxjaXJjbGUgY3g9IjEwMCIgY3k9IjEwMCIgcj0iMTAwIiBmaWxsPSJibGFjayIvPgo8cGF0aCBkPSJNMTM1LjIgNjIuNDAwNUMxNDAuOTQ0IDYyLjQwMDUgMTQ1LjYgNjcuMDU2NyAxNDUuNiA3Mi44MDA1VjEzNS4yQzE0NS42IDE0MC45NDQgMTQwLjk0NCAxNDUuNiAxMzUuMiAxNDUuNlY2Mi40MDA1WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTU3LjIgNjIuNDAwNUM1Ny4yIDU2LjY1NjcgNjEuODU2MiA1Mi4wMDA1IDY3LjYgNTIuMDAwNUgxMTQuNEMxMjAuMTQ0IDUyLjAwMDUgMTI0LjggNTYuNjU2NyAxMjQuOCA2Mi40MDA1VjE0NS42QzEyNC44IDE1MS4zNDQgMTIwLjE0NCAxNTYgMTE0LjQgMTU2SDY3LjZDNjEuODU2MiAxNTYgNTcuMiAxNTEuMzQ0IDU3LjIgMTQ1LjZWNjIuNDAwNVoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xNTYgNzIuODAwNUMxNjAuMzA4IDcyLjgwMDUgMTYzLjggNzYuMjkyNyAxNjMuOCA4MC42MDA1VjEyNy40QzE2My44IDEzMS43MDggMTYwLjMwOCAxMzUuMiAxNTYgMTM1LjJWNzIuODAwNVoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPg==",onclick:function(){(0,l.dispatch)(a).setEditor(e),(0,l.dispatch)(a).toggleModal(!0)}})}))})();